(()=>{var e={918:function(e){var t,n;e.exports=(t={509:(e,t,n)=>{function r(e,t){const n=e.data&&e.data.length||0,r=s(n,4);r.splice(4,0,...s(e.type,t));const i=new Uint8Array(r.length+n);return i.set(r),i.set(e.data||[],r.length),i}function s(e,t){if(e>Number.MAX_SAFE_INTEGER)throw"Number too big to reliably convert";const n=[];for(;t>0;)t--,n.push(e/Math.pow(256,t)&255);return n}function i(e){if(!function(e){let t=!1;return(e=e.filter((e=>!(0==e&&!t||(t=!0,0))))).length<7||7==e.length&&e[0]<=31}(e))throw"Number too big to reliably convert";let t=e.length,n=0,r=0;for(;t>0;)t--,n+=(255&e[r++])*Math.pow(256,t);return n}e.exports={constructRawPacket:function(e){return r(e,1)},destructRawPacket:function(e){return{size:i(e.slice(0,4)),type:e[4],data:e.slice(5)}},constructVirtualPacket:function(e){return r(e,2)},destructVirtualPacket:function(e){return{size:i(e.slice(0,4)),type:i(e.slice(4,6)),data:e.slice(6)}},constructParameters:function(e){return new Uint8Array([s(e.length,2),...e.map((e=>[s(e.type,2),s(e.size,2),s(e.value,e.size)].flat()))].flat())},destructParameters:function(e){const t=[],n=i(e.slice(0,2));let r=2;for(let s=0;s<n;s++){const n=i(e.slice(r+3,r+5));t.push({type:i(e.slice(r,r+2)),ok:0==e[r+2],size:n,value:i(e.slice(r+5,r+5+n))}),r+=5+n}return t},intToBytes:s,bytesToInt:i,asciiToBytes:function(e,t){t=t||e.length+1;const r=new("undefined"!=typeof TextEncoder?TextEncoder:n(790).TextEncoder)("utf-8").encode(e),s=new Uint8Array(t);return s.set(r.slice(0,t)),s},bytesToAscii:function(e){const t=e.indexOf(0);return t>=0&&(e=e.slice(0,t)),new("undefined"!=typeof TextDecoder?TextDecoder:n(790).TextDecoder)("utf-8").decode(e)},chunkArray:function(e,t){const n=[];let r,s=0;for(r=0;r<t.length;r++)if(n.push(e.slice(s,s+t[r])),s+=t[r],s>=e.length)return n;for(r--;s<e.length;)n.push(e.slice(s,s+t[r])),s+=t[r];return n}}},24:e=>{e.exports={identifier:{vendorId:1105}}},770:(e,t,n)=>{const r={name:"TI-83 Premium CE",status:"beta",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-83 Premium CE"}},s=n(256);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},484:(e,t,n)=>{const r={name:"TI-84 Plus CE",status:"beta",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-84 Plus CE"}},s=n(256);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},699:(e,t,n)=>{const r={name:"TI-82 Advanced",status:"experimental",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-82 Advanced"}},s=n(875);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},662:(e,t,n)=>{const r={name:"TI-84 Plus",status:"supported",identifier:{vendorId:1105,productId:57347},matcher:{vendorId:1105,productId:57347}},s=n(875);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},340:(e,t,n)=>{const r={name:"TI-84 Plus C Silver Edition",status:"experimental",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-84 Plus C Silver Edition"}},s=n(875);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},986:(e,t,n)=>{const r={name:"TI-84 Plus SE",status:"beta",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-84 Plus Silver Edition"}},s=n(875);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},659:(e,t,n)=>{const r={name:"TI-84 Plus T",status:"experimental",identifier:{vendorId:1105,productId:57352},matcher:{vendorId:1105,productId:57352,productName:"TI-84 Plus T"}},s=n(875);e.exports={...r,connect:e=>new s({device:e,properties:r}).connect()}},725:(e,t,n)=>{const r=n(225),s=n(509);e.exports=class{constructor(e){this._device=e}async connect(){await this._device.open(),await this._device.selectConfiguration(this._device.configuration.configurationValue);const e=this._device.configuration.interfaces[0];await this._device.claimInterface(e.interfaceNumber),this._inEndpoint=e.alternates[0].endpoints.find((e=>"in"==e.direction)),this._outEndpoint=e.alternates[0].endpoints.find((e=>"out"==e.direction)),this._bufferSize=await this._requestBufferSize()}async send(e){const t=s.constructVirtualPacket(e),n=s.chunkArray(t||[],[this._bufferSize-r.rawPacketTypes.HEADER_SIZE]);for(let e=0;e<n.length;e++){const t=e==n.length-1?r.rawPacketTypes.DUSB_RPKT_VIRT_DATA_LAST:r.rawPacketTypes.DUSB_RPKT_VIRT_DATA,i=n[e];await this._send(s.constructRawPacket({type:t,data:i})),await this._expectAck()}}async expect(e){const t=s.destructRawPacket(await this._receive());if(t.type!=r.rawPacketTypes.DUSB_RPKT_VIRT_DATA_LAST)throw`Expected raw packet type VIRT_DATA_LAST, but got ${t.type} instead`;const n=s.destructVirtualPacket(t.data);switch(n.type){case e:return await this._sendAck(),n;case r.virtualPacketTypes.DUSB_VPKT_DELAY_ACK:await this._sendAck();const t=s.bytesToInt(n.data);return await this.wait(t/1e3),this.expect(e);default:throw`Expected virtual packet type ${e}, but got ${n.type} instead`}}wait(e){return new Promise(((t,n)=>{setTimeout((()=>t()),e)}))}async _requestBufferSize(){await this._send(s.constructRawPacket({type:r.rawPacketTypes.DUSB_RPKT_BUF_SIZE_REQ,data:[0,0,4,0]}));const e=s.destructRawPacket(await this._receive());if(e.type!=r.rawPacketTypes.DUSB_RPKT_BUF_SIZE_ALLOC)throw`Expected BUF_SIZE_ALLOC, got ${e.type} instead`;return s.bytesToInt(e.data)}_send(e){return this._device.transferOut(this._outEndpoint.endpointNumber,e)}async _receive(){const e=await this._device.transferIn(this._inEndpoint.endpointNumber,this._inEndpoint.packetSize);if("ok"!=e.status)throw`Error in receiving data from device: ${e.status}`;return new Uint8Array(e.data.buffer)}_sendAck(){return this._send(s.constructRawPacket({type:r.rawPacketTypes.DUSB_RPKT_VIRT_DATA_ACK,data:[224,0]}))}async _expectAck(){const e=s.destructRawPacket(await this._receive());if(e.type!=r.rawPacketTypes.DUSB_RPKT_VIRT_DATA_ACK)throw`Expected ACK, got ${e.type} instead`}}},256:(e,t,n)=>{const r=n(875);e.exports=class extends r{async getFreeMem(){const e=await super.getFreeMem();return 0==e.ram&&(e.ram=void 0),e}}},225:e=>{e.exports={rawPacketTypes:{DUSB_RPKT_BUF_SIZE_REQ:1,DUSB_RPKT_BUF_SIZE_ALLOC:2,DUSB_RPKT_VIRT_DATA:3,DUSB_RPKT_VIRT_DATA_LAST:4,DUSB_RPKT_VIRT_DATA_ACK:5},virtualPacketTypes:{DUSB_VPKT_DELAY_ACK:1}}},790:e=>{e.exports={TextEncoder:class{encode(e){return(new TextEncoder).encode(e)}},TextDecoder:class{decode(e){return(new TextDecoder).decode(e)}}}},875:e=>{e.exports=class{constructor(e){this._device=e.device,this._properties=e.properties}async getFreeMem(){return await this._device.controlTransferOut({requestType:"class",recipient:"interface",request:0,value:0,index:0})}}}};return t},function(){var e=this,n=e&&e.modules||e||(e={});t(),n.exports=e})()});
